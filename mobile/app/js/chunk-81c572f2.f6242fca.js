(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-81c572f2"],{1348:function(e,r,n){"use strict";n.r(r);var o=function(){var e=this,r=e.$createElement,n=e._self._c||r;return n("div",{staticClass:"form-page"},[n("van-cell-group",{staticClass:"form"},[n("form",{ref:"userForm",attrs:{method:"POST"},on:{submit:function(r){return r.preventDefault(),e.login(r)}}},[n("van-field",{attrs:{required:"",clearable:"",error:!!e.errorMsg.username,placeholder:e.errorMsg.username?e.errorMsg.username:"请输入用户名",autofocus:"autofocus",label:"用户名","error-message":e.userForm.username?e.errorMsg.username:""},on:{focus:function(r){e.errorMsg.username=""},blur:function(r){return e.checkupForm("username")}},model:{value:e.userForm.username,callback:function(r){e.$set(e.userForm,"username",r)},expression:"userForm.username"}}),n("van-field",{attrs:{required:"",clearable:"",error:!!e.errorMsg.phonenumber,placeholder:e.errorMsg.phonenumber?e.errorMsg.phonenumber:"请输入手机号",autofocus:"autofocus",label:"手机号","error-message":e.userForm.phonenumber?e.errorMsg.phonenumber:""},on:{focus:function(r){e.errorMsg.phonenumber=""},blur:function(r){return e.checkupForm("phonenumber")}},model:{value:e.userForm.phonenumber,callback:function(r){e.$set(e.userForm,"phonenumber",r)},expression:"userForm.phonenumber"}}),n("div",[n("van-row",{attrs:{type:"flex",align:"center"}},[n("van-col",{attrs:{span:"18"}},[n("van-field",{attrs:{required:"",clearable:"",error:!!e.errorMsg.phonenumbercode,placeholder:e.errorMsg.phonenumbercode?e.errorMsg.phonenumbercode:"请输入短信验证码",autofocus:"autofocus",label:"短信验证码","error-message":e.userForm.phonenumbercode?e.errorMsg.phonenumbercode:""},on:{focus:function(r){e.errorMsg.phonenumbercode=""}},model:{value:e.userForm.phonenumbercode,callback:function(r){e.$set(e.userForm,"phonenumbercode",r)},expression:"userForm.phonenumbercode"}})],1),n("van-col",{attrs:{span:"6"}},[n("van-button",{attrs:{type:"primary",size:"small",disabled:!e.cansendcode},on:{click:e.sendPhoneCode}},[e._v(e._s(0==e.phoneCodeTime?"获取验证码":"重试("+e.phoneCodeTime+"秒)"))])],1)],1),n("div",{staticClass:"phonenumber-row"})],1),n("van-field",{attrs:{type:"password",label:"密码",error:!!e.errorMsg.password,placeholder:e.errorMsg.password?e.errorMsg.password:"请输入密码","error-message":e.userForm.password?e.errorMsg.password:"",required:""},on:{focus:function(r){e.errorMsg.password=""},blur:function(r){return e.checkupForm("password")}},model:{value:e.userForm.password,callback:function(r){e.$set(e.userForm,"password",r)},expression:"userForm.password"}}),n("van-field",{attrs:{type:"password",label:"重复密码",error:!!e.errorMsg.password2,placeholder:e.errorMsg.password2?e.errorMsg.password2:"请输入密码","error-message":e.userForm.password2?e.errorMsg.password2:"",required:""},on:{focus:function(r){e.errorMsg.password2=""},blur:function(r){return e.checkupForm("password2")}},model:{value:e.userForm.password2,callback:function(r){e.$set(e.userForm,"password2",r)},expression:"userForm.password2"}}),n("div",{staticClass:"login"},[n("van-button",{attrs:{type:"info",size:"normal"},on:{click:e.register}},[e._v("注册")])],1)],1)])],1)},t=[],s=(n("96cf"),n("3b8d")),u=n("8a1f"),a=n("2b0e"),c={mixins:[u["a"]],data:function(){var e=this;return{userForm:{username:"",password:"",phonenumber:"",phonenumbercode:"",password2:""},errorMsg:{username:"",password:"",phonenumber:"",phonenumbercode:"",password2:""},validates:{username:function(){var r=Object(s["a"])(regeneratorRuntime.mark((function r(n){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,e.checkName(n,!0);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r)})));function n(e){return r.apply(this,arguments)}return n}(),password:function(){var r=Object(s["a"])(regeneratorRuntime.mark((function r(n){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,e.checkPass(n);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r)})));function n(e){return r.apply(this,arguments)}return n}(),phonenumber:function(){var r=Object(s["a"])(regeneratorRuntime.mark((function r(n){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,e.checkPhoneNumber(n);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r)})));function n(e){return r.apply(this,arguments)}return n}(),password2:function(){var r=Object(s["a"])(regeneratorRuntime.mark((function r(n){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n!=e.userForm.password){r.next=4;break}return r.abrupt("return","");case 4:return r.abrupt("return","重复密码与密码不一致");case 5:case"end":return r.stop()}}),r)})));function n(e){return r.apply(this,arguments)}return n}()},phoneCodeSending:!1,phoneCodeTime:0}},computed:{cansendcode:function(){return this.userForm.phonenumber&&!this.errorMsg.phonenumber&&!this.phoneCodeSending&&0==this.phoneCodeTime}},methods:{register:function(){var e=this;a["a"].axios.post("/user/register",this.userForm).then((function(){e.$toast({message:"注册成功"}),setTimeout((function(){return e.$router.push("/login")}),1e3)}))},checkupForm:function(e){var r=this,n=this.userForm[e];this.validates[e](n).then((function(n){r.errorMsg[e]=n}))},updatePhoneCodeTime:function(){var e=this;this.phoneCodeTime--,this.phoneCodeTime&&setTimeout((function(){return e.updatePhoneCodeTime()}),1e3)},sendPhoneCode:function(){var e=this;this.phoneCodeSending=!0,this.phoneCodeTime=60,this.updatePhoneCodeTime(),a["a"].axios.post("/user/phonenumbercode",{phonenumber:this.userForm.phonenumber,username:this.userForm.username}).then((function(){e.$toast({message:"验证码发送成功,请留意手机短信"}),e.phoneCodeSending=!1})).catch((function(){e.$toast({type:"fail",message:"验证码发送失败,请稍后重试",icon:"warn-o"}),e.phoneCodeSending=!1}))}}},i=c,m=(n("e4d7"),n("2877")),p=Object(m["a"])(i,o,t,!1,null,"0c404834",null);r["default"]=p.exports},"8a1f":function(e,r,n){"use strict";n("96cf");var o=n("3b8d"),t=n("b255"),s=n("2b0e");r["a"]={methods:{checkName:function(e){var r=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise((function(o,s){var u=t["c"];e.length<6?o("用户名长度必须为6到12位"):u.test(e)?n&&r.getUserExist(e).then((function(e){o(e?"用户名已存在":"")})):o("请输入合法用户名(字母开头的字母/数字任意组合)")}))},checkPass:function(e){return new Promise((function(r,n){var o=t["b"],s="";e.length<6?s="请输入6到12位长度的密码":o.test(e)||(s="含有非法字符,请重新输入"),r(s)}))},checkEmail:function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise((function(n,o){var u=t["a"];u.test(e)?r&&s["a"].axios.get("/user/emailexist?email=".concat(e)).then((function(e){e.data?n("邮箱已被使用,请绑定其他邮箱"):n("")})):n("请输入正确的邮箱地址")}))},checkPhoneNumberExist:function(e){return new Promise((function(r,n){var o=/^1([38]\d|5[0-35-9]|7[3678])\d{8}$/;o.test(e)?s["a"].axios.get("/user/phonenumberexist?phonenumber=".concat(e)).then((function(e){e.data?r(""):r("输入的手机号未注册")})):r("请输入正确的手机号")}))},checkPhoneNumber:function(e){return new Promise((function(r,n){var o=/^1([38]\d|5[0-35-9]|7[3678])\d{8}$/;o.test(e)?s["a"].axios.get("/user/phonenumberexist?phonenumber=".concat(e)).then((function(e){e.data?r("手机号已被使用,请绑定其他号码"):r("")})):r("请输入正确的手机号")}))},getUserExist:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(r){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,s["a"].axios.get("/user/userexist?username=".concat(r)).then((function(e){n=e.data}));case 2:return e.abrupt("return",n);case 3:case"end":return e.stop()}}),e)})));function r(r){return e.apply(this,arguments)}return r}()}}},b255:function(e,r,n){"use strict";n.d(r,"c",(function(){return o})),n.d(r,"b",(function(){return t})),n.d(r,"a",(function(){return s}));var o=/^\w[\d\w]{5,11}$/,t=/^[\d\w~!@#$%^&()_+=-]{6,12}$/,s=/^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/},e4d7:function(e,r,n){"use strict";var o=n("f329"),t=n.n(o);t.a},f329:function(e,r,n){}}]);